# 2023年7月19日

## 2進数から文字列を復元

- 2進数から文字への復元する

```bash

root@72c59b32fdde:/shell/qdata/80# cat zeroone
# 11100100101110001000110111100101100010101011010011100110100010011000000011100101101111101001011100001010

```

```bash

cat zeroone | 
    sed 's/^/obase=16;ibase=2;/' |
    bc |
    xxd -p -r

```

- sedの先頭にobase=16;base=2;という文字を加え、bcとxxdに通している
  - obase=16は、bcの出力を16進数に変換する
  - ibase=2は、bcの入力を2進数に変換する
  - bcは、数式を計算するコマンド
  - xxd -p -rは、16進数をバイナリに変換するコマンド
    - -rはリバースの意味
    - 16進数を羅列したテキストを読んでデコードする

## BOMの識別

- UTF-8のBOMに関する問題

```bash

root@72c59b32fdde:/shell/qdata/81# cat bom.txt
# ボムボムプリンおいしい
root@72c59b32fdde:/shell/qdata/81# cat nobom.txt
# ボムボムプリン完売

```

- UTF-8には通常BOMは入らないが、入っている場合もある
  - その場合、BOMは3byteで0xEFBBBF
- ファイルにBOMが入っている場出力の先頭に[BOM]を付加し、入っていなければ何も不可しないで文字列を出力するワンライナーを考える

> BOMとは
> byte order mark
> バイトオーダーマークは、Unicodeの符号化形式の一つであるUTF-16やUTF-32において、エンディアンを識別するために先頭に付加される特殊な文字のことである。
> Microsoft ExcelなどのアプリケーションによってはBOM付きでなければ符号化方式がUTF-8なのかUTF-16なのか、またはUTF-32なのか、あるいはまったく別の文字コードなのか判断できないことがあります。一方、Webページとして使用されるHTMLファイルの場合はBOM無しで保存・上書きする方が良いとされています。これはWebページを動的に処理するPHPなどのプログラムがBOM付きのテキストファイルを正常に処理することができないことがあるからです。このようにシチュエーションによりどちらの方が良いという事は一概には言えません。(<https://uxmilk.jp/48923>)
