# 第三火曜の列挙

```bash
seq -f '20210101 %g day' 0 364
```

- seqの`-f`はフォーマットに数字を当てはめて出力するためのオプション

```bash

seq -f '20210101 %g day' 0 364 |
    date -f - '+%F %w' |
    awk '/2$/{print $1}' |
    awk '{print $0,++a[substr($1,1,7)]}'

```

- 連想配列aを作り、awkのsubstr関数で日付から、最初から7文字の年月だけを切り出し、それをキーにして数字をカウントし、そのまま2列目に出力している

```bash

seq -f '20210101 %g day' 0 364 |
    date -f - '+%F %w' |
    awk '/2$/{print $1}' |
    awk '++a[substr($1,1,7)]==3'

```

1. `seq -f '20210101 %g day' 0 364`

    このコマンドをディスエクションしてみましょう。
    - `seq`は指定した範囲の数列を生成します。ここでは `0` から `364`までの数列を生成します。なお、`364`は1年間の日数（365日）から1を引いた値です。
    - `-f`オプションを使用すると、出力する数値のフォーマットを指定できます。ここでは `20210101 %g day`というフォーマット文字列を指定しています。`%g`は数列の値（0〜364）に置き換えられます。したがって、このコマンドは「20210101 0 day」と「20210101 364 day」の間の文字列を生成します。

2. `|date -f - '+%F %w'`

    - `|`記号はパイプと呼ばれ、左側のコマンドからの出力を右側のコマンドへの入力として送ります。
    - `date -f - '+%F %w'`は変換された日付（`20210101 %g day`）とその曜日の情報を返します。`-f -`はstdinから日付文字列を読み取ることを指定します。`+%F %w`のフォーマットは、先頭の4文字（年）、次の2文字（月）、次の2文字（日）の形式の日付と、その日が一週間の何日目であるかを出力します。

3. `|awk '/2$/{print $1}'`

    - `awk`はテキストを処理するプログラミング言語です。ここではパイプからの出力を1行ずつ処理します。
    - `/2$/`は行の末尾が2である行をフィルタリングします。この場合、2は火曜日を意味します（0は日曜日、1は月曜日、2は火曜日...）。
    - `{print $1}`はフィルタリングされた行の1番目のフィールド（日付）を出力します。

4. `|awk '++a[substr($1,1,7)]==3'`

    - ここでもawkを使っています。この段階では、出力はすべて2021年の火曜日の日期です。
    - `substr($1,1,7)`は行の1番目のフィールドを取得し、その最初の7文字（年と月）を返します。
    - `++a[substr($1,1,7)]==3`は先ほどの文字列をキーとする関連配列`a`の要素をインクリメントし、その値が3である場合にその行を出力します。すなわち、各月の火曜日が3日目になる日を出力します。
