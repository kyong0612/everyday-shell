# 5文字以上のカタカナ言葉を使ったらアウト
```bash
root@515126588d63:/shell/qdata/35# cat speech.txt
# 21世紀に入ってからのIT業界を中心としたパラダイムシフトは目まぐるしく、各業界はスクラップアンドスクラップでフリーダムです。
# ジャストアイデアですが、既存の価値観にとらわれない、いわゆるコペルニクス的転回によるトイレシェアリングを検討しています。
# 個人間であらゆるアセットをシェアするビジネスが注目を浴びており、共有経済、いわゆるシェアリングエコノミーについても弊社はアジャイルにフルコミットする姿勢です。
# 顧客体験の高品質化、満足度、いわゆるサティスファクションを最大化する、それこそオポチュニティマネージメントの目的でありイニシアチブをとる理由というやつです。
```
- カナ文字を判定する正規表現
```regex
[ァ-ヴ][ァ-ヴー・]*
```
- 5文字以上のカタカナ言葉を使ったらアウト
```regex
[ァ-ヴ][ァ-ヴー・]{4,}
```

- 各行最後の4文字以上のカナ言葉まで抽出される
```bash
cat speech.txt | grep -oP '^.*[ア-ン]{4}'
```
```bash
root@515126588d63:/shell/qdata/35# cat speech.txt | grep -oP '^.*[ア-ン]{4}'
# 21世紀に入ってからのIT業界を中心としたパラダイムシフトは目まぐるしく、各業界はスクラップアンドスクラップ
# ジャストアイデアですが、既存の価値観にとらわれない、いわゆるコペルニクス的転回によるトイレシェアリング
# 個人間であらゆるアセットをシェアするビジネスが注目を浴びており、共有経済、いわゆるシェアリングエコノミーについても弊社はアジャイルにフルコミット
# 顧客体験の高品質化、満足度、いわゆるサティスファクションを最大化する、それこそオポチュニティマネージメントの目的でありイニシアチブ
```

- 4文字で打ち切るために、最短一致にする
    - `.*` -> `.*?`にへんこうする

```bash
cat speech.txt | grep -oP '^.*?[ア-ン]{4}'
```
```bash
root@515126588d63:/shell/qdata/35# cat speech.txt | grep -oP '^.*?[ア-ン]{4}'
# 21世紀に入ってからのIT業界を中心としたパラダイ
# ジャスト
# 個人間であらゆるアセット
# 顧客体験の高品質化、満足度、いわゆるサティス
```

- `[ア-ン]{4}(?=[ア-ン])`
    - カタカナ5文字で構成される文字列の先頭4文字にマッチ

```bash
cat speech.txt | grep -oP '^.*?[ア-ン]{4}(?=[ア-ン])'
```
```bash
root@515126588d63:/shell/qdata/35# cat speech.txt | grep -oP '^.*?[ア-ン]{4}(?=[ア-ン])'
# 21世紀に入ってからのIT業界を中心としたパラダイ
# ジャスト
# 個人間であらゆるアセットをシェアするビジネスが注目を浴びており、共有経済、いわゆるシェアリ
# 顧客体験の高品質化、満足度、いわゆるサティス
```

- 文字数をカウントする
```bash
cat speech.txt \
| grep -oP '^.*?[ア-ン]{4}(?=[ア-ン])' \
| awk '{$2=$1}$1=length($2)' 
```
- このawkでは、最初のアクションで$1に入った各行の文字列を$2に退避して、次のパターンで$1を文字列の長さlength($2)に置き換えている
- lengthではbyte数をカウントしている
```bash
root@515126588d63:/shell/qdata/35# cat speech.txt | grep -Po '^.*?[ア-ン]{4}(?=[ア-ン])' | awk '{$2=$1}$1=length($2)'
# 67 21世紀に入ってからのIT業界を中心としたパラダイ
# 12 ジャスト
# 135 個人間であらゆるアセットをシェアするビジネスが注目を浴びており、共有経済、いわゆるシェアリ
# 66 顧客体験の高品質化、満足度、いわゆるサティス
```


# grepのoption
- `-o`
    - マッチした部分だけを出力する
- `-P`
    - perlの正規表現を使う
